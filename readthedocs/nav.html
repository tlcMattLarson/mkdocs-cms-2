{%- if nav_item.url %}
    <li><a class="{% if nav_item.active%}current{%endif%}{%- if nav_item == page or nav_item.children %} collapsible-nav{%endif%}" href="{{ nav_item.url }}">{{ nav_item.title }}</a>
      {%- if nav_item == page or nav_item.children %}
          <ul class="subnav" style="display:none;">
              {%- if nav_item == page %}
                  {% include 'toc.html' %}
              {%- endif %}
              {%- if nav_item.children %}
                  {%- set navlevel = navlevel + 1%}
                  {%- for nav_item in nav_item.children %}
                      <li class="{% if navlevel > 2 %}toctree-l{{ navlevel }}{% endif %}{% if nav_item.active%} current{%endif%}">
                          {% include 'nav.html' %}
                      </li>
                  {%- endfor %}
                  {%- set navlevel = navlevel - 1%}
              {%- endif %}
          </ul>
      {%- endif %}
    </li>
{%- else %}
    <li><span class="caption-text {% if nav_item.active%} current{%endif%}{%- if nav_item == page or nav_item.children %} collapsible-nav{%endif%}">{{ nav_item.title }}</span>
      {%- if nav_item == page or nav_item.children %}
          <ul class="subnav" style="display:none;">
              {%- if nav_item == page %}
                  {% include 'toc.html' %}
              {%- endif %}
              {%- if nav_item.children %}
                  {%- set navlevel = navlevel + 1%}
                  {%- for nav_item in nav_item.children %}
                      <li class="{% if navlevel > 2 %}toctree-l{{ navlevel }}{% endif %}{% if nav_item.active%} current{%endif%}">
                          {% include 'nav.html' %}
                      </li>
                  {%- endfor %}
                  {%- set navlevel = navlevel - 1%}
              {%- endif %}
          </ul>
      {%- endif %}
    </li>
{%- endif %}
